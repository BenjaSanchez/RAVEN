<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of getModelFromMetaCyc</title>
  <meta name="keywords" content="getModelFromMetaCyc">
  <meta name="description" content="getModelFromMetaCyc">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html v1.5 &copy; 2003-2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../../index.html">Home</a> &gt;  <a href="../index.html">external</a> &gt; <a href="index.html">metacyc</a> &gt; getModelFromMetaCyc.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../../index.html"><img alt="<" border="0" src="../../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for external\metacyc&nbsp;<img alt=">" border="0" src="../../right.png"></a></td></tr></table>-->

<h1>getModelFromMetaCyc
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>getModelFromMetaCyc</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>function metaCycModel=getModelFromMetaCyc(metacycPath,keepTransportRxns,keepUnbalanced,keepUndetermined) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre class="comment"> getModelFromMetaCyc
   Retrieves information stored in MetaCyc flat files and generates a super model


   metacycPath         if metaCycRxns.mat is not in the RAVEN\external\metacyc
                       directory, this function will attempt to read data
                       from a local dump of the metacyc database. metacycPath
                       is the path to the root of this database
   keepTransportRxns   include transportation reactions, which often have identical
                       reactants and products that turn to be all-zero columns in
                       the S matrix (opt, default false)
   keepUnbalanced      include reactions cannot be unbalanced reactions, usually
                       because they are polymeric reactions or because of a
                       specific difficulty in balancing class structures
                       (opt, default false)
   keepUndetermined    include reactions that have substrates lack chemical
                       structures or with non-numerical coefficients (e.g. n+1)
                       (opt, default false)

   metaCycModel        a model structure generated from MetaCyc database
                       including all reactions and metabolites in MetaCyc

   Usage: getModelFromMetaCyc(metacycPath)

   Hao Wang, 2017-06-17</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../matlabicon.gif)">
<li><a href="getEnzymesFromMetaCyc.html" class="code" title="function metaCycEnzymes=getEnzymesFromMetaCyc(metacycPath)">getEnzymesFromMetaCyc</a>	getEnzymesFromMetaCyc</li><li><a href="getMetsFromMetaCyc.html" class="code" title="function metaCycMets=getMetsFromMetaCyc(metacycPath)">getMetsFromMetaCyc</a>	getMetsFromMetaCyc</li><li><a href="getRxnsFromMetaCyc.html" class="code" title="function model=getRxnsFromMetaCyc(metacycPath,keepTransportRxns,keepUnbalanced,keepUndetermined)">getRxnsFromMetaCyc</a>	getRxnsFromMetaCyc</li></ul>
This function is called by:
<ul style="list-style-image:url(../../matlabicon.gif)">
<li><a href="getMetaCycModelForOrganism.html" class="code" title="function model=getMetaCycModelForOrganism(organismID,fastaFile,keepTransportRxns,keepUnbalanced,keepUndetermined,minScore,minPositives)">getMetaCycModelForOrganism</a>	getMetaCycModelForOrganism</li></ul>
<!-- crossreference -->



<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function metaCycModel=getModelFromMetaCyc(metacycPath,keepTransportRxns,keepUnbalanced,keepUndetermined)</a>
0002 <span class="comment">% getModelFromMetaCyc</span>
0003 <span class="comment">%   Retrieves information stored in MetaCyc flat files and generates a super model</span>
0004 <span class="comment">%</span>
0005 <span class="comment">%</span>
0006 <span class="comment">%   metacycPath         if metaCycRxns.mat is not in the RAVEN\external\metacyc</span>
0007 <span class="comment">%                       directory, this function will attempt to read data</span>
0008 <span class="comment">%                       from a local dump of the metacyc database. metacycPath</span>
0009 <span class="comment">%                       is the path to the root of this database</span>
0010 <span class="comment">%   keepTransportRxns   include transportation reactions, which often have identical</span>
0011 <span class="comment">%                       reactants and products that turn to be all-zero columns in</span>
0012 <span class="comment">%                       the S matrix (opt, default false)</span>
0013 <span class="comment">%   keepUnbalanced      include reactions cannot be unbalanced reactions, usually</span>
0014 <span class="comment">%                       because they are polymeric reactions or because of a</span>
0015 <span class="comment">%                       specific difficulty in balancing class structures</span>
0016 <span class="comment">%                       (opt, default false)</span>
0017 <span class="comment">%   keepUndetermined    include reactions that have substrates lack chemical</span>
0018 <span class="comment">%                       structures or with non-numerical coefficients (e.g. n+1)</span>
0019 <span class="comment">%                       (opt, default false)</span>
0020 <span class="comment">%</span>
0021 <span class="comment">%   metaCycModel        a model structure generated from MetaCyc database</span>
0022 <span class="comment">%                       including all reactions and metabolites in MetaCyc</span>
0023 <span class="comment">%</span>
0024 <span class="comment">%   Usage: getModelFromMetaCyc(metacycPath)</span>
0025 <span class="comment">%</span>
0026 <span class="comment">%   Hao Wang, 2017-06-17</span>
0027 <span class="comment">%</span>
0028 
0029 <span class="keyword">if</span> nargin&lt;1
0030     metacycPath=<span class="string">''</span>;
0031 <span class="keyword">end</span>
0032 <span class="keyword">if</span> nargin&lt;2
0033     keepTransportRxns=false;
0034 <span class="keyword">end</span>
0035 <span class="keyword">if</span> nargin&lt;3
0036     keepUnbalanced=false;
0037 <span class="keyword">end</span>
0038 <span class="keyword">if</span> nargin&lt;4
0039     keepUndetermined=false;
0040 <span class="keyword">end</span>
0041 
0042 <span class="comment">%First get all reactions</span>
0043 metaCycModel=<a href="getRxnsFromMetaCyc.html" class="code" title="function model=getRxnsFromMetaCyc(metacycPath,keepTransportRxns,keepUnbalanced,keepUndetermined)">getRxnsFromMetaCyc</a>(metacycPath,keepTransportRxns,keepUnbalanced,keepUndetermined);
0044 fprintf(<span class="string">'MetaCyc reactions loaded\n'</span>);
0045 
0046 <span class="comment">%Get reaction and enzyme association</span>
0047 metaCycEnzymes=<a href="getEnzymesFromMetaCyc.html" class="code" title="function metaCycEnzymes=getEnzymesFromMetaCyc(metacycPath)">getEnzymesFromMetaCyc</a>(metacycPath);
0048 fprintf(<span class="string">'MetaCyc enzymes loaded\n'</span>);
0049 
0050 <span class="comment">%Replace rxnNames with those from metaCycEnzymes</span>
0051 [a, b]=ismember(metaCycModel.rxns,metaCycEnzymes.rxns);
0052 a=find(a);
0053 b=b(a);
0054 metaCycModel.rxnNames(a)=metaCycEnzymes.rxnNames(b);
0055 
0056 <span class="comment">%Create the rxnGeneMat for the reactions, by geting all enzymes and</span>
0057 <span class="comment">%corresponding subunits</span>
0058 rxnNum=numel(metaCycModel.rxns);
0059 metaCycModel.genes=metaCycEnzymes.enzymes;
0060 metaCycModel.rxnGeneMat=sparse(rxnNum,numel(metaCycEnzymes.enzymes));
0061 metaCycModel.grRules=cell(rxnNum,1);
0062 
0063 <span class="comment">%Loop through all reactions to generate rxnGeneMat matrix and grRules</span>
0064 <span class="comment">%This step also cross-link reactions to their catalyzing enzymes</span>
0065 <span class="keyword">for</span> i=1:rxnNum
0066 
0067     metaCycModel.grRules{i}=<span class="string">''</span>;
0068     <span class="comment">%Find out if this is an enzymatic reaction</span>
0069     [a, b]=ismember(metaCycModel.rxns(i),metaCycEnzymes.rxns);
0070     <span class="keyword">if</span> a
0071         I=[];   <span class="comment">%Find out all catalyzing enzymes, which are treated as isoenzymes</span>
0072         I=find(metaCycEnzymes.rxnEnzymeMat(b,:));
0073         <span class="keyword">if</span> ~isempty(I)
0074             
0075             grRule=<span class="string">''</span>;
0076             <span class="keyword">for</span> j=1:numel(I)
0077                                 
0078                 subgrRule=<span class="string">''</span>; <span class="comment">%Find out if enzyme complex</span>
0079                 [c, d]=ismember(metaCycEnzymes.enzymes(I(j)),metaCycEnzymes.cplxs);
0080                 <span class="keyword">if</span> c
0081                         <span class="keyword">for</span> k=1:numel(metaCycEnzymes.cplxComp{d}.subunit)
0082                             <span class="keyword">if</span> strcmp(subgrRule,<span class="string">''</span>)
0083                                 subgrRule=strcat(<span class="string">'('</span>,metaCycEnzymes.cplxComp{d}.subunit{k});
0084                             <span class="keyword">else</span>
0085                                 subgrRule=strcat(subgrRule,{<span class="string">' and '</span>},metaCycEnzymes.cplxComp{d}.subunit{k});
0086                             <span class="keyword">end</span>
0087                             
0088                             [x, geneIndex]=ismember(metaCycEnzymes.cplxComp{d}.subunit{k},metaCycModel.genes);
0089                             <span class="comment">%if x</span>
0090                                 metaCycModel.rxnGeneMat(i,geneIndex)=1;
0091                             <span class="comment">%else</span>
0092                             <span class="comment">%    disp(metaCycEnzymes.cplxComp{d}.subunit{k});</span>
0093                             <span class="comment">%end</span>
0094                         <span class="keyword">end</span>
0095                         subgrRule=strcat(subgrRule,<span class="string">')'</span>);
0096                 <span class="keyword">else</span>
0097                         subgrRule=metaCycEnzymes.enzymes(I(j));
0098                         metaCycModel.rxnGeneMat(i,I(j))=1;
0099                 <span class="keyword">end</span>
0100                 
0101                 <span class="comment">%Generating grRules</span>
0102                 <span class="keyword">if</span> ~strcmp(subgrRule,<span class="string">''</span>)
0103                     <span class="keyword">if</span> ~strcmp(grRule,<span class="string">''</span>)
0104                         grRule=strcat(grRule,{<span class="string">' or '</span>},subgrRule);
0105                     <span class="keyword">else</span>
0106                         grRule=subgrRule;
0107                     <span class="keyword">end</span>
0108                 <span class="keyword">end</span>
0109                 
0110             <span class="keyword">end</span>
0111             metaCycModel.grRules{i}=grRule;
0112                         
0113         <span class="keyword">end</span>
0114 
0115     <span class="keyword">end</span>
0116 <span class="keyword">end</span>
0117 
0118 <span class="comment">%Then get all metabolites</span>
0119 metaCycMets=<a href="getMetsFromMetaCyc.html" class="code" title="function metaCycMets=getMetsFromMetaCyc(metacycPath)">getMetsFromMetaCyc</a>(metacycPath);
0120 fprintf(<span class="string">'MetaCyc compounds loaded\n'</span>);
0121 
0122 <span class="comment">%Add information about all metabolites to the model</span>
0123 [a, b]=ismember(metaCycModel.mets,metaCycMets.mets);
0124 a=find(a);
0125 b=b(a);
0126 
0127 <span class="keyword">if</span> ~isfield(metaCycModel,<span class="string">'metNames'</span>)
0128    metaCycModel.metNames=cell(numel(metaCycModel.mets),1);
0129    metaCycModel.metNames(:)={<span class="string">''</span>};
0130 <span class="keyword">end</span>
0131 metaCycModel.metNames(a)=metaCycMets.metNames(b);
0132 
0133 <span class="keyword">if</span> ~isfield(metaCycModel,<span class="string">'metFormulas'</span>)
0134    metaCycModel.metFormulas=cell(numel(metaCycModel.mets),1);
0135    metaCycModel.metFormulas(:)={<span class="string">''</span>};
0136 <span class="keyword">end</span>
0137 metaCycModel.metFormulas(a)=metaCycMets.metFormulas(b);
0138 
0139 <span class="keyword">if</span> ~isfield(metaCycModel,<span class="string">'metCharge'</span>)
0140    metaCycModel.metCharge=zeros(numel(metaCycModel.mets),1);
0141 <span class="keyword">end</span>
0142 metaCycModel.metCharge(a)=metaCycMets.metCharge(b);
0143 
0144 <span class="keyword">if</span> ~isfield(metaCycModel,<span class="string">'inchis'</span>)
0145    metaCycModel.inchis=cell(numel(metaCycModel.mets),1);
0146    metaCycModel.inchis(:)={<span class="string">''</span>};
0147 <span class="keyword">end</span>
0148 metaCycModel.inchis(a)=metaCycMets.inchis(b);
0149 
0150 <span class="keyword">if</span> ~isfield(metaCycModel,<span class="string">'metMiriams'</span>)
0151    metaCycModel.metMiriams=cell(numel(metaCycModel.mets),1);
0152 <span class="keyword">end</span>
0153 metaCycModel.metMiriams(a)=metaCycMets.metMiriams(b);
0154 
0155 <span class="keyword">if</span> ~isfield(metaCycModel,<span class="string">'keggid'</span>)
0156    metaCycModel.keggid=cell(numel(metaCycModel.mets),1);
0157 <span class="keyword">end</span>
0158 metaCycModel.keggid(a)=metaCycMets.keggid(b);
0159 
0160 <span class="comment">%Put all metabolites in one compartment called 's' (for system). This is</span>
0161 <span class="comment">%done just to be more compatible with the rest of the code</span>
0162 metaCycModel.comps={<span class="string">'s'</span>};
0163 metaCycModel.compNames={<span class="string">'System'</span>};
0164 metaCycModel.compOutside={<span class="string">''</span>};
0165 metaCycModel.metComps=ones(numel(metaCycModel.mets),1);
0166 
0167 <span class="comment">%If reactions with undefined stoichiometry are kept, then the corresponding</span>
0168 <span class="comment">%metabolites will have ids such as &quot;(n+1) C000001&quot; and their names will be</span>
0169 <span class="comment">%empty. These ids are not valid SBML identifiers and are therefore replaced</span>
0170 <span class="comment">%with &quot;undefined1, undefined2...&quot;. The former ids are stored as the new</span>
0171 <span class="comment">%names</span>
0172 <span class="comment">%I=find(cellfun(@any,strfind(metaCycModel.mets,'n')) | cellfun(@any,strfind(metaCycModel.mets,'m')));</span>
0173 <span class="comment">%I=find(cellfun(@any,strfind(metaCycModel.mets,'n')) | cellfun(@any,strfind(metaCycModel.mets,'m')) | cellfun(@any,strfind(metaCycModel.mets,'n+1')) | cellfun(@any,strfind(metaCycModel.mets,'m+1')));</span>
0174 <span class="comment">%metaCycModel.metNames(I)=metaCycModel.mets(I);</span>
0175 <span class="comment">%repNums=1:numel(I);</span>
0176 <span class="comment">%repIDs=strcat('undefined_',cellfun(@num2str,num2cell(repNums(:)),'UniformOutput',false));</span>
0177 <span class="comment">%metaCycModel.mets(I)=repIDs;</span>
0178 
0179 <span class="comment">%It could also be that the metabolite and reaction names are empty</span>
0180 <span class="comment">%for some reasons. In that case, use the ID instead</span>
0181 I=cellfun(@isempty,metaCycModel.metNames);
0182 metaCycModel.metNames(I)=metaCycModel.mets(I);
0183 I=cellfun(@isempty,metaCycModel.rxnNames);
0184 metaCycModel.rxnNames(I)=metaCycModel.rxns(I);
0185 
0186 <span class="keyword">end</span></pre></div>
<hr><address>Generated on Wed 01-Nov-2017 16:53:54 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" title="Matlab Documentation in HTML">m2html</a></strong> &copy; 2005</address>
</body>
</html>