<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of tutorial2</title>
  <meta name="keywords" content="tutorial2">
  <meta name="description" content="This contains the code necessary for running Exercises 2. It is assumed">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html v1.5 &copy; 2003-2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../index.html">Home</a> &gt;  <a href="index.html">tutorial</a> &gt; tutorial2.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../index.html"><img alt="<" border="0" src="../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for tutorial&nbsp;<img alt=">" border="0" src="../right.png"></a></td></tr></table>-->

<h1>tutorial2
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>This contains the code necessary for running Exercises 2. It is assumed</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>This is a script file. </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre class="comment">This contains the code necessary for running Exercises 2. It is assumed
that you have completed Exercises 1 before.</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="../core/findGeneDeletions.html" class="code" title="function [genes fluxes originalGenes details]=findGeneDeletions(model,testType,analysisType,refModel,oeFactor)">findGeneDeletions</a>	findGeneDeletions</li><li><a href="../core/followChanged.html" class="code" title="function followChanged(model,fluxesA,fluxesB, cutOffChange, cutOffFlux, cutOffDiff, metaboliteList)">followChanged</a>	followChanged</li><li><a href="../core/getExchangeRxns.html" class="code" title="function [exchangeRxns, exchangeRxnsIndexes]=getExchangeRxns(model,reactionType)">getExchangeRxns</a>	getExchangeRxns</li><li><a href="../core/getIndexes.html" class="code" title="function indexes=getIndexes(model,objects, type, returnLogical)">getIndexes</a>	getIndexes</li><li><a href="../core/printFluxes.html" class="code" title="function printFluxes(model, fluxes, onlyExchange, cutOffFlux, outputFile,outputString,metaboliteList)">printFluxes</a>	printFluxes</li><li><a href="../core/setParam.html" class="code" title="function model=setParam(model, paramType, rxnList, params)">setParam</a>	setParam</li><li><a href="../io/SBMLFromExcel.html" class="code" title="function SBMLFromExcel(fileName, outputFileName,toCOBRA,printWarnings)">SBMLFromExcel</a>	SBMLFromExcel</li><li><a href="../io/importExcelModel.html" class="code" title="function model=importExcelModel(fileName,removeExcMets,printWarnings,ignoreErrors)">importExcelModel</a>	importExcelModel</li><li><a href="../io/importModel.html" class="code" title="function model=importModel(fileName,removeExcMets,isCOBRA,supressWarnings)">importModel</a>	importModel</li><li><a href="../pathway/trimPathway.html" class="code" title="function pathway=trimPathway(pathway, rxnsToKeep, deleteUnconnectedMets)">trimPathway</a>	trimPathway</li><li><a href="../plotting/drawMap.html" class="code" title="function notMapped=drawMap(title,pathway,modelA,conditionA,conditionB,modelB,filename,cutOff)">drawMap</a>	drawMap</li><li><a href="../solver/qMOMA.html" class="code" title="function [fluxA,fluxB, flag]=qMOMA(modelA,modelB,fluxMinWeight)">qMOMA</a>	qMOMA</li><li><a href="../solver/solveLP.html" class="code" title="function [solution hsSolOut prob]=solveLP(model,minFlux,params,hsSol)">solveLP</a>	solveLP</li></ul>
This function is called by:
<ul style="list-style-image:url(../matlabicon.gif)">
</ul>
<!-- crossreference -->



<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre>0001 <span class="comment">%This contains the code necessary for running Exercises 2. It is assumed</span>
0002 <span class="comment">%that you have completed Exercises 1 before.</span>
0003 
0004 <span class="comment">%Loads the model</span>
0005 model=<a href="../io/importExcelModel.html" class="code" title="function model=importExcelModel(fileName,removeExcMets,printWarnings,ignoreErrors)">importExcelModel</a>(<span class="string">'smallYeast.xlsx'</span>,true);
0006 
0007 <span class="comment">%Sets the upper bound of glucose uptake to 1 and O2 uptake to unlimited.</span>
0008 model=<a href="../core/setParam.html" class="code" title="function model=setParam(model, paramType, rxnList, params)">setParam</a>(model,<span class="string">'ub'</span>,{<span class="string">'glcIN'</span> <span class="string">'o2IN'</span>},[1 1000]);
0009 <span class="comment">%Set the objective to be ethanol production</span>
0010 model=<a href="../core/setParam.html" class="code" title="function model=setParam(model, paramType, rxnList, params)">setParam</a>(model,<span class="string">'obj'</span>,{<span class="string">'ethOUT'</span>},1);
0011 
0012 <span class="comment">%Solve the model</span>
0013 sol=<a href="../solver/solveLP.html" class="code" title="function [solution hsSolOut prob]=solveLP(model,minFlux,params,hsSol)">solveLP</a>(model);
0014 
0015 <span class="comment">%Print the resulting exchange fluxes</span>
0016 <a href="../core/printFluxes.html" class="code" title="function printFluxes(model, fluxes, onlyExchange, cutOffFlux, outputFile,outputString,metaboliteList)">printFluxes</a>(model,sol.x,true);
0017 
0018 <span class="comment">%This is for comparing two flux distributions</span>
0019 <span class="comment">%Load the map</span>
0020 load <span class="string">'pathway.mat'</span> pathway;
0021 <a href="../plotting/drawMap.html" class="code" title="function notMapped=drawMap(title,pathway,modelA,conditionA,conditionB,modelB,filename,cutOff)">drawMap</a>(<span class="string">'Aerobic vs Anaerobic'</span>,pathway,model,solA.x,solB.x,[],<span class="string">'mapFBA.pdf'</span>,10^-5);
0022 
0023 <span class="comment">%This is for running a single gene deletion</span>
0024 [genes fluxes originalGenes details]=<a href="../core/findGeneDeletions.html" class="code" title="function [genes fluxes originalGenes details]=findGeneDeletions(model,testType,analysisType,refModel,oeFactor)">findGeneDeletions</a>(model,<span class="string">'sgd'</span>,<span class="string">'fba'</span>);
0025 
0026 <span class="comment">%Get the indexes of these reactions</span>
0027 I=<a href="../core/getIndexes.html" class="code" title="function indexes=getIndexes(model,objects, type, returnLogical)">getIndexes</a>(model,{<span class="string">'biomassOUT'</span>},<span class="string">'rxns'</span>);
0028 J=<a href="../core/getIndexes.html" class="code" title="function indexes=getIndexes(model,objects, type, returnLogical)">getIndexes</a>(model,{<span class="string">'glyOUT'</span>},<span class="string">'rxns'</span>);
0029 
0030 okSolutions=find(fluxes(I,:)&gt;10^-2); <span class="comment">%Only look at solutions which are still growing</span>
0031 [maxGlycerol J]=max(fluxes(J,okSolutions));
0032 maxGlycerol
0033 originalGenes(genes(okSolutions(J),:))
0034 
0035 <span class="comment">%Draw map for the ZWF1 deletion strain</span>
0036 model2=<a href="../core/setParam.html" class="code" title="function model=setParam(model, paramType, rxnList, params)">setParam</a>(model,<span class="string">'eq'</span>,{<span class="string">'ZWF'</span>},0);
0037 sol2=<a href="../solver/solveLP.html" class="code" title="function [solution hsSolOut prob]=solveLP(model,minFlux,params,hsSol)">solveLP</a>(model2);
0038 <a href="../plotting/drawMap.html" class="code" title="function notMapped=drawMap(title,pathway,modelA,conditionA,conditionB,modelB,filename,cutOff)">drawMap</a>(<span class="string">'ZWF1 deletion vs WT'</span>,pathway,model,sol.x,sol2.x,[],<span class="string">'mapZWF.pdf'</span>,10^-5);
0039 <a href="../core/followChanged.html" class="code" title="function followChanged(model,fluxesA,fluxesB, cutOffChange, cutOffFlux, cutOffDiff, metaboliteList)">followChanged</a>(model,sol2.x,sol.x, 10, 10^-2, 0,{<span class="string">'NADPH'</span> <span class="string">'NADH'</span> <span class="string">'NAD'</span> <span class="string">'NADP'</span>});
0040 
0041 <span class="comment">%Load the model</span>
0042 <a href="../io/SBMLFromExcel.html" class="code" title="function SBMLFromExcel(fileName, outputFileName,toCOBRA,printWarnings)">SBMLFromExcel</a>(<span class="string">'smallYeast.xlsx'</span>,<span class="string">'smallYeast.xml'</span>)
0043 model=<a href="../io/importModel.html" class="code" title="function model=importModel(fileName,removeExcMets,isCOBRA,supressWarnings)">importModel</a>(<span class="string">'smallYeast.xml'</span>,true);
0044 sol=<a href="../solver/solveLP.html" class="code" title="function [solution hsSolOut prob]=solveLP(model,minFlux,params,hsSol)">solveLP</a>(model);
0045 
0046 <span class="comment">%Define another model where all exchange reactions are open.</span>
0047 model2=model;
0048 I=<a href="../core/getIndexes.html" class="code" title="function indexes=getIndexes(model,objects, type, returnLogical)">getIndexes</a>(model,<a href="../core/getExchangeRxns.html" class="code" title="function [exchangeRxns, exchangeRxnsIndexes]=getExchangeRxns(model,reactionType)">getExchangeRxns</a>(model),<span class="string">'rxns'</span>);
0049 model2.lb(I)=0;
0050 model2.ub(I)=1000;
0051 
0052 <span class="comment">%Then delete ZWF</span>
0053 model2=<a href="../core/setParam.html" class="code" title="function model=setParam(model, paramType, rxnList, params)">setParam</a>(model2,<span class="string">'eq'</span>,{<span class="string">'ZWF'</span>},0);
0054 
0055 <span class="comment">%Then run MOMA</span>
0056 [fluxA,fluxB, flag]=<a href="../solver/qMOMA.html" class="code" title="function [fluxA,fluxB, flag]=qMOMA(modelA,modelB,fluxMinWeight)">qMOMA</a>(model,model2);
0057 <a href="../plotting/drawMap.html" class="code" title="function notMapped=drawMap(title,pathway,modelA,conditionA,conditionB,modelB,filename,cutOff)">drawMap</a>(<span class="string">'Aerobic vs Anaerobic MOMA'</span>,pathway,model,fluxA,fluxB,[],<span class="string">'mapMOMA.pdf'</span>,10^-5);
0058 
0059 <span class="comment">%Read microarray results and calculate reporter metabolites (metabolites</span>
0060 <span class="comment">%around which there are significant transcriptional changes)</span>
0061 [orfs,pvalues]=textread(<span class="string">'expression.txt'</span>,<span class="string">'%s%f'</span>);
0062 repMets=reporterMets(model,orfs,pvalues);
0063 [I J]=sort(repMets.metPValues);
0064  
0065 fprintf(<span class="string">'TOP 10 REPORTER METABOLITES:\n'</span>);
0066 <span class="keyword">for</span> i=1:min(numel(J),10)
0067    fprintf([repMets.mets{J(i)} <span class="string">'\t'</span> num2str(I(i)) <span class="string">'\n'</span>]) 
0068 <span class="keyword">end</span>
0069  
0070 <span class="comment">%Get all reactions involving those metabolites and display them on a map</span>
0071 mets=ismember(model.mets,repMets.mets(J(1:10)));
0072 [crap I]=find(model.S(mets,:));
0073 pathway=<a href="../pathway/trimPathway.html" class="code" title="function pathway=trimPathway(pathway, rxnsToKeep, deleteUnconnectedMets)">trimPathway</a>(pathway, model.rxns(I), true);
0074 <a href="../plotting/drawMap.html" class="code" title="function notMapped=drawMap(title,pathway,modelA,conditionA,conditionB,modelB,filename,cutOff)">drawMap</a>(<span class="string">'Reactions involving the top 10 Reporter Metabolites'</span>,pathway,model,ones(numel(model.rxns),1),zeros(numel(model.rxns),1),[],<span class="string">'mapRM.pdf'</span>,10^-5);</pre></div>
<hr><address>Generated on Fri 14-Oct-2016 12:02:10 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" title="Matlab Documentation in HTML">m2html</a></strong> &copy; 2005</address>
</body>
</html>